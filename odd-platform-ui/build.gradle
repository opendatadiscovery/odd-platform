plugins {
    id 'java'
    id "com.github.node-gradle.node" version "3.1.0"
}

node {
    download = true
    version = "16.14.0"
}

tasks.register("buildUI", NpmTask) {
    mkdir "${project.buildDir}/ui"
    inputs.files(fileTree("${project.projectDir}/node_modules"))
    inputs.files(fileTree("${project.projectDir}/src"))
    inputs.file("${project.projectDir}/package.json")

    outputs.dir("${project.buildDir}/ui")

    dependsOn npmInstall
    environment = [
        'BUILD_PATH': "${project.buildDir}/ui"
    ]
    args = ['run', 'build']
}

jar {
    dependsOn 'buildUI'
    from "${project.buildDir}/ui" into 'static'
}
